<!doctype html><html lang=en><head><title>Get SharePoint Document Check-In Comment and ETag in Power Automate · Mabster.NET</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=color-scheme content="light dark"><meta name=author content="Matt Hamilton"><meta name=description content="When you&rsquo;re building a Power Automate workflow that to approve files in SharePoint, you need the ETag property from the item, but you probably also want the &ldquo;check-in comment&rdquo; that the user enters when they click &ldquo;Submit for Approval&rdquo;. Here&rsquo;s how to get both in one step!"><meta name=keywords content="blog,developer,personal"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://mabster.net/images/thumbnail.png"><meta name=twitter:title content="Get SharePoint Document Check-In Comment and ETag in Power Automate"><meta name=twitter:description content="When you’re building a Power Automate workflow that to approve files in SharePoint, you need the ETag property from the item, but you probably also want the “check-in comment” that the user enters when they click “Submit for Approval”. Here’s how to get both in one step!"><meta property="og:url" content="https://mabster.net/posts/flow-sharepoint-check-in-comment/"><meta property="og:site_name" content="Mabster.NET"><meta property="og:title" content="Get SharePoint Document Check-In Comment and ETag in Power Automate"><meta property="og:description" content="When you’re building a Power Automate workflow that to approve files in SharePoint, you need the ETag property from the item, but you probably also want the “check-in comment” that the user enters when they click “Submit for Approval”. Here’s how to get both in one step!"><meta property="og:locale" content="en_au"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-12-15T16:00:00+11:00"><meta property="article:modified_time" content="2025-12-15T16:00:00+11:00"><meta property="article:tag" content="SharePoint"><meta property="article:tag" content="Power-Automate"><meta property="og:image" content="https://mabster.net/images/thumbnail.png"><link rel=canonical href=https://mabster.net/posts/flow-sharepoint-check-in-comment/><link rel=preload href=/fonts/fa-brands-400.woff2 as=font type=font/woff2 crossorigin><link rel=preload href=/fonts/fa-regular-400.woff2 as=font type=font/woff2 crossorigin><link rel=preload href=/fonts/fa-solid-900.woff2 as=font type=font/woff2 crossorigin><link rel=stylesheet href=/css/coder.min.d34edd71874acbeb3a3eb5107f9c17feea692c93694a14fa043253bbc2870bc4.css integrity="sha256-007dcYdKy+s6PrUQf5wX/uppLJNpShT6BDJTu8KHC8Q=" crossorigin=anonymous media=screen><link rel=stylesheet href=/css/coder-dark.min.1f9882ae5be1d5a9f377e2ddf450e2bf1b8493f2e8354db91cf21834f790371a.css integrity="sha256-H5iCrlvh1anzd+Ld9FDivxuEk/LoNU25HPIYNPeQNxo=" crossorigin=anonymous media=screen><link rel=stylesheet href=/custom.min.82314e159b01e3d46353bd31e035fe64ca87253f10f259c8ae306fcc8f68fe8d.css integrity="sha256-gjFOFZsB49RjU70x4DX+ZMqHJT8Q8lnIrjBvzI9o/o0=" crossorigin=anonymous media=screen><link rel=icon type=image/svg+xml href=/images/favicon.svg sizes=any><link rel=icon type=image/png href=/images/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/images/favicon-16x16.png sizes=16x16><link rel=apple-touch-icon href=/images/favicon-32x32.png><link rel=apple-touch-icon sizes=180x180 href=/images/favicon-32x32.png><link rel=manifest href=/site.webmanifest><link rel=mask-icon href=/images/safari-pinned-tab.svg color=#5bbad5></head><body class="preload-transitions colorscheme-dark"><div class=float-container><a id=dark-mode-toggle class=colorscheme-toggle><i class="fa-solid fa-adjust fa-fw" aria-hidden=true></i></a></div><main class=wrapper><nav class=navigation><section class=container><a class=navigation-title href=https://mabster.net/>Mabster.NET
</a><input type=checkbox id=menu-toggle>
<label class="menu-button float-right" for=menu-toggle><i class="fa-solid fa-bars fa-fw" aria-hidden=true></i></label><ul class=navigation-list><li class=navigation-item><a class=navigation-link href=/posts/>Posts</a></li></ul></section></nav><div class=content><section class="container post"><article><header><div class=post-title><h1 class=title style=view-transition-name:post-title-index><a class=title-link href=https://mabster.net/posts/flow-sharepoint-check-in-comment/>Get SharePoint Document Check-In Comment and ETag in Power Automate</a></h1></div><div class=post-meta><div class=date><span class=posted-on><i class="fa fa-calendar" aria-hidden=true></i>
<time datetime=2025-12-15T16:00:00+11:00>15 Dec 2025
</time></span><span class=reading-time><i class="fa fa-clock-o" aria-hidden=true></i>
2-minute read
</span><span><a href=https://github.com/mabster/mabster.github.io/tree/main/content/posts/flow-sharepoint-check-in-comment/index.md><i class="fa fa-github"></i> View on GitHub</a></span></div><div class=tags><i class="fa-solid fa-tag" aria-hidden=true></i>
<span class=tag><a href=/tags/sharepoint/>SharePoint</a>
</span><span class=separator>•</span>
<span class=tag><a href=/tags/power-automate/>Power-Automate</a></span></div></div></header><div class=post-content><div style=view-transition-name:post-summary-index><p>When you&rsquo;re building a Power Automate workflow that to approve files in SharePoint, you need the ETag property from the item, but you probably also want the &ldquo;check-in comment&rdquo; that the user enters when they click &ldquo;Submit for Approval&rdquo;. Here&rsquo;s how to get both in one step!</p></div><p>I&rsquo;ve found a lot of posts around the Internet describing how to retrieve the check-in comment for a document in SharePoint that your workflow is requesting approval for. Typically you&rsquo;d want to include that comment in the approval request, so that the approver has some context about what changed in this version of the document. None of the posts, though, are as simple as this, and none of them combine it with fetching the document item&rsquo;s ETag, which is also required when approving or rejecting the document.</p><p>The idea is to use the SharePoint REST API to fetch the underlying <code>File</code> object associated with the item. That&rsquo;ll give you both properties in one request!</p><p><img src=Get_ETag_and_Comment.png alt="A screenshot of the Send HTTP Request to SharePoint step in Power Automate"></p><p>In the image above you can see I&rsquo;m using our flow triggers to specify the site, library and item Id, but the crux is that you&rsquo;ll need this URL:</p><pre tabindex=0><code>_api/web/lists(&#39;&lt;your library GUID&gt;&#39;)/items(&lt;your item Id&gt;)/File
</code></pre><p>You&rsquo;ll also want to make sure you&rsquo;re supplying the <code>accept</code> header with a value of <code>application/json</code> so you get a nice minimal JSON payload back from SharePoint.</p><p>To use the returned check-in comment in a subsequent action, you can use an expression like this (noting that my step&rsquo;s name is &ldquo;Get_ETag_and_Comment&rdquo; but yours might be different:</p><pre tabindex=0><code>body(&#39;Get_ETag_and_Comment&#39;)?[&#39;CheckInComment&#39;]
</code></pre><p>… and likewise to get the ETag you&rsquo;d use this expression:</p><pre tabindex=0><code>body(&#39;Get_ETag_and_Comment&#39;)?[&#39;ETag&#39;]
</code></pre></div><footer></footer></article></section></div><footer class=footer><section class=container>©
2025
Matt Hamilton
·
Powered by <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a> & <a href=https://github.com/luizdepra/hugo-coder/ target=_blank rel=noopener>Coder</a>.</section></footer></main><script src=/js/coder.min.6ae284be93d2d19dad1f02b0039508d9aab3180a12a06dcc71b0b0ef7825a317.js integrity="sha256-auKEvpPS0Z2tHwKwA5UI2aqzGAoSoG3McbCw73gloxc="></script></body></html>